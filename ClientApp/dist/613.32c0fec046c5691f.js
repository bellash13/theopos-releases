"use strict";(self.webpackChunktheopos=self.webpackChunktheopos||[]).push([[613],{2613:(h,p,s)=>{s.r(p),s.d(p,{ProductsModule:()=>B});var l=s(9808),a=s(1797),c=s(5425),t=s(1223),d=s(2291),u=s(2382),m=s(2290);function _(r,n){if(1&r&&(t.TgZ(0,"dl",1)(1,"dt",4),t._uU(2,"Produit"),t.qZA(),t.TgZ(3,"dd",4),t._uU(4),t.qZA(),t.TgZ(5,"dt",4),t._uU(6,"Quantit\xe9 achet\xe9e"),t.qZA(),t.TgZ(7,"dd",4),t._uU(8),t.qZA(),t.TgZ(9,"dt",4),t._uU(10,"Quantit\xe9 vendue"),t.qZA(),t.TgZ(11,"dd",4),t._uU(12),t.qZA(),t.TgZ(13,"dt",4),t._uU(14,"Quantit\xe9"),t.qZA(),t.TgZ(15,"dd",4),t._uU(16),t.qZA(),t.TgZ(17,"dt",4),t._uU(18,"Date"),t.qZA(),t.TgZ(19,"dd",4),t._uU(20),t.ALo(21,"date"),t.qZA()()),2&r){const o=n.$implicit;t.xp6(4),t.Oqu(o.idProduct),t.xp6(4),t.Oqu(o.orderedQuantity),t.xp6(4),t.Oqu(o.soldQuantity),t.xp6(4),t.Oqu(o.quantity),t.xp6(4),t.Oqu(t.xi3(21,5,null==o.lastUpdate?null:o.lastUpdate.toDate(),"dd/MM/yyyy hh:mm"))}}const g=function(r){return{"bg-danger text-white":r}};function Z(r,n){if(1&r&&(t.TgZ(0,"tr",15),t._UZ(1,"td"),t.TgZ(2,"td",12),t._uU(3),t.qZA(),t.TgZ(4,"td",12),t._uU(5),t.qZA(),t.TgZ(6,"td",12),t._uU(7),t.qZA(),t.TgZ(8,"td",13),t._uU(9),t.ALo(10,"date"),t.qZA(),t._UZ(11,"td"),t.qZA()),2&r){const o=n.$implicit;t.Q6J("ngClass",t.VKq(8,g,!(null!=o&&null!=o.delivery&&o.delivery.inOut))),t.xp6(3),t.Oqu(o.qtyPurchase),t.xp6(2),t.Oqu(o.qtyReceive),t.xp6(2),t.Oqu(o.qtyReceived),t.xp6(2),t.Oqu(t.xi3(10,5,null==o||null==o.delivery||null==o.delivery.receiptDate?null:o.delivery.receiptDate.toDate(),"dd/MM/yyyy"))}}function f(r,n){if(1&r&&(t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"dl",1)(5,"dt",4),t._uU(6,"Produit"),t.qZA(),t.TgZ(7,"dd",4),t._uU(8),t.qZA(),t.TgZ(9,"dt",4),t._uU(10,"Code & Description"),t.qZA(),t.TgZ(11,"dd",4),t._uU(12),t.qZA(),t.TgZ(13,"dt",4),t._uU(14,"Prix d'achat"),t.qZA(),t.TgZ(15,"dd",4),t._uU(16),t.qZA(),t.TgZ(17,"dt",4),t._uU(18,"Prix de vente"),t.qZA(),t.TgZ(19,"dd",4),t._uU(20),t.qZA()()()()(),t.TgZ(21,"div",5)(22,"div",2)(23,"div",3)(24,"h4"),t._uU(25,"STOCK"),t.qZA(),t.YNc(26,_,22,8,"dl",6),t.qZA()(),t.TgZ(27,"div",7)(28,"div",3)(29,"h6"),t._uU(30,"MOUVEMENTS"),t.qZA(),t.TgZ(31,"div",8)(32,"div",9),t._uU(33,"Mouvements sortants"),t.qZA(),t._UZ(34,"div",10),t.qZA(),t.TgZ(35,"table",11)(36,"tr"),t._UZ(37,"th"),t.TgZ(38,"th",12),t._uU(39,"Qt\xe9 achet\xe9e"),t.qZA(),t.TgZ(40,"th",12),t._uU(41,"Qt\xe9 \xe0 livrer"),t.qZA(),t.TgZ(42,"th",12),t._uU(43,"Qt\xe9 re\xe7ue"),t.qZA(),t.TgZ(44,"th",13),t._uU(45,"Date"),t.qZA(),t._UZ(46,"th"),t.qZA(),t.YNc(47,Z,12,10,"tr",14),t.qZA()()()(),t.BQk()),2&r){const o=t.oxw();t.xp6(8),t.Oqu(o.currentProduct.name),t.xp6(4),t.AsE("",o.currentProduct.productId," ",o.currentProduct.description,""),t.xp6(4),t.Oqu(o.currentProduct.pricePurchase),t.xp6(4),t.Oqu(o.currentProduct.priceSell),t.xp6(6),t.Q6J("ngForOf",o.currentProduct.inventories),t.xp6(21),t.Q6J("ngForOf",o.currentProduct.deliveryLines)}}let x=(()=>{class r{constructor(o,e,i,v){this.route=o,this.productsApiServ=e,this.fb=i,this.toastr=v}ngOnInit(){this.querify()}querify(){var o;null===(o=this.route.parent)||void 0===o||o.paramMap.subscribe(e=>{const i=e.get("id");i&&"0"!=i&&this.getProduct(i)})}getProduct(o){this.productsApiServ.details(o).subscribe(e=>{this.currentProduct=e})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(c.gz),t.Y36(d.b0),t.Y36(u.qu),t.Y36(m._W))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-products-details"]],decls:3,vars:1,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-4"],[1,"card","card-body"],[1,"col-md-6"],[1,"row","mt-2"],["class","row",4,"ngFor","ngForOf"],[1,"col-md-8"],[1,"row","mb-2"],[1,"col-md-11","text-end"],[1,"col-md-1","bg-danger","text-white"],[1,"table","table-borderless"],[1,"text-end","pe-2"],[1,"text-center"],["class","border-top",3,"ngClass",4,"ngFor","ngForOf"],[1,"border-top",3,"ngClass"]],template:function(o,e){1&o&&(t.TgZ(0,"h1"),t._uU(1,"DETAILS DU PRODUIT"),t.qZA(),t.YNc(2,f,48,7,"ng-container",0)),2&o&&(t.xp6(2),t.Q6J("ngIf",e.currentProduct))},directives:[l.O5,l.sg,l.mk],pipes:[l.uU],styles:[""]}),r})();var T=s(2277),b=s(6152);let P=(()=>{class r{transform(o,...e){return(null==o?void 0:o.errors)&&((null==o?void 0:o.touched)||(null==o?void 0:o.dirty))||!1}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275pipe=t.Yjl({name:"validationFor",type:r,pure:!0}),r})();function A(r,n){if(1&r&&(t.ynx(0),t.TgZ(1,"div",4)(2,"a",5),t._uU(3,"Dernier produit"),t.qZA()(),t.BQk()),2&r){const o=t.oxw();t.xp6(2),t.MGl("routerLink","/products/",o.lastProductId,"/details")}}function C(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function U(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function q(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function F(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function I(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function y(r,n){1&r&&(t.TgZ(0,"div",25),t._uU(1," Valeur invalide "),t.qZA())}function E(r,n){if(1&r){const o=t.EpF();t.ynx(0),t.TgZ(1,"form",6)(2,"div",1)(3,"div",7)(4,"div",8)(5,"label",9),t._uU(6,"Code-barres"),t.qZA(),t.TgZ(7,"div"),t._UZ(8,"input",10),t.ALo(9,"toFormControl"),t.YNc(10,C,2,0,"div",11),t.ALo(11,"validationFor"),t.qZA()()(),t.TgZ(12,"div",12)(13,"div",8)(14,"label",13),t._uU(15,"Identifiant unique"),t.qZA(),t.TgZ(16,"div",12),t._UZ(17,"input",14),t.ALo(18,"toFormControl"),t.YNc(19,U,2,0,"div",11),t.ALo(20,"validationFor"),t.qZA()(),t.TgZ(21,"div",8)(22,"label",13),t._uU(23,"Nom"),t.qZA(),t.TgZ(24,"div",12),t._UZ(25,"input",15),t.ALo(26,"toFormControl"),t.YNc(27,q,2,0,"div",11),t.ALo(28,"validationFor"),t.qZA()(),t.TgZ(29,"div",8)(30,"label",13),t._uU(31,"Description"),t.qZA(),t.TgZ(32,"div",12),t._UZ(33,"input",16),t.ALo(34,"toFormControl"),t.YNc(35,F,2,0,"div",11),t.ALo(36,"validationFor"),t.qZA()(),t.TgZ(37,"div",8)(38,"label",13),t._uU(39,"Prix d'achat"),t.qZA(),t.TgZ(40,"div",12),t._UZ(41,"input",17),t.ALo(42,"toFormControl"),t.YNc(43,I,2,0,"div",11),t.ALo(44,"validationFor"),t.qZA()(),t.TgZ(45,"div",8)(46,"label",13),t._uU(47,"Prix de vente"),t.qZA(),t.TgZ(48,"div",12),t._UZ(49,"input",18),t.ALo(50,"toFormControl"),t.YNc(51,y,2,0,"div",11),t.ALo(52,"validationFor"),t.qZA()(),t.TgZ(53,"div",19),t._UZ(54,"div",7),t.TgZ(55,"div",7)(56,"button",20),t.NdJ("click",function(){return t.CHM(o),t.oxw().save()}),t._UZ(57,"i",21),t._uU(58," Sauvegarder"),t.qZA()(),t.TgZ(59,"div",22)(60,"button",23),t.NdJ("click",function(){return t.CHM(o),t.oxw().delete()}),t._UZ(61,"i",24),t._uU(62," Supprimer"),t.qZA()()()()()(),t.BQk()}if(2&r){const o=t.oxw();t.xp6(1),t.Q6J("formGroup",o.productForm),t.xp6(7),t.Q6J("formControl",t.lcZ(9,13,o.productForm.get("barCode"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,15,o.productForm.get("barCode"))),t.xp6(7),t.Q6J("formControl",t.lcZ(18,17,o.productForm.get("productId"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(20,19,o.productForm.get("productId"))),t.xp6(6),t.Q6J("formControl",t.lcZ(26,21,o.productForm.get("name"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(28,23,o.productForm.get("name"))),t.xp6(6),t.Q6J("formControl",t.lcZ(34,25,o.productForm.get("description"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(36,27,o.productForm.get("description"))),t.xp6(6),t.Q6J("formControl",t.lcZ(42,29,o.productForm.get("pricePurchase"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(44,31,o.productForm.get("pricePurchase"))),t.xp6(6),t.Q6J("formControl",t.lcZ(50,33,o.productForm.get("priceSell"))),t.xp6(2),t.Q6J("ngIf",t.lcZ(52,35,o.productForm.get("priceSell")))}}let L=(()=>{class r{constructor(o,e,i,v,R){this.route=o,this.productsApiServ=e,this.fb=i,this.router=v,this.toastr=R,this.lastProductId="",this.priceIndex=1.2}ngOnInit(){this.querify(),this.buildForm()}querify(){var o;null===(o=this.route.parent)||void 0===o||o.paramMap.subscribe(e=>{const i=e.get("id");i&&"0"!=i&&this.getProduct(i)})}getProduct(o){this.productsApiServ.details(o).subscribe(e=>{this.currentProduct=e,this.buildForm()})}buildForm(){var o;this.currentProduct||(this.currentProduct=new d.dc),this.productForm=this.fb.group({barCode:[this.currentProduct.barCode,[]],name:[this.currentProduct.name,[u.kI.required]],description:[this.currentProduct.description,[u.kI.required]],pricePurchase:[this.currentProduct.pricePurchase,[]],priceSell:[this.currentProduct.priceSell,[]],productId:[this.currentProduct.productId,[u.kI.required]]}),null===(o=this.productForm.get("pricePurchase"))||void 0===o||o.valueChanges.subscribe(e=>{var i;const v=(e||0)*this.priceIndex;null===(i=this.productForm.get("priceSell"))||void 0===i||i.setValue(v)})}save(){if(this.productForm.invalid){const e=T.M.getFormGroupErrors(this.productForm).join("\n");return void this.toastr.error("Formulaire invalide.\n\n"+e)}const o=new d.m6(this.productForm.value);!o.productId&&this.productsApiServ.create(o).subscribe(e=>{this.toastr.success("Produit sauvegard\xe9 avec succ\xe8s."),this.lastProductId=e.productId||"",this.currentProduct=null,this.buildForm()},e=>{this.toastr.error("Impossible de cr\xe9er ce produit.")}),o.productId&&this.productsApiServ.edit(o.productId,o).subscribe(e=>{this.toastr.success("Produit mis \xe0 jour avec succ\xe8s."),this.router.navigateByUrl(`/products/${o.productId}/details`),this.currentProduct=null},e=>{this.toastr.error("Impossible de cr\xe9er ce produit.")})}delete(){const o=new d.m6(this.productForm.value);confirm("Voulez-vous vraiment supprimer ce produit?")&&o.productId&&this.productsApiServ.delete(o.productId).subscribe(e=>{this.toastr.success("Produit supprim\xe9 avec succ\xe8s."),this.router.navigateByUrl("/products/list"),this.currentProduct=null},e=>{this.toastr.error("Impossible de supprimer ce produit.")})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(c.gz),t.Y36(d.b0),t.Y36(u.qu),t.Y36(c.F0),t.Y36(m._W))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-products-edit"]],decls:6,vars:2,consts:[[4,"ngIf"],[1,"row"],[1,"col-md-12"],[1,"mb-4","text-center"],[1,"text-end"],[3,"routerLink"],[3,"formGroup"],[1,"col-md-4"],[1,"form-group","mb-2","row"],["for","",1,"pt-2","mb-4"],["placeholder","Scanner code-barres du produit",1,"form-control",3,"formControl"],["class","text-danger",4,"ngIf"],[1,"col-md-8"],["for","",1,"col-md-4","text-end","pt-2"],["placeholder","Code du produit",1,"form-control",3,"formControl"],["placeholder","Nom du produit",1,"form-control",3,"formControl"],["placeholder","D\xe9crire le produit",1,"form-control",3,"formControl"],["type","number","step","0.0001","placeholder","Prix d'achat",1,"form-control",3,"formControl"],["type","number","step","0.0001","placeholder","Prix de vente",1,"form-control",3,"formControl"],[1,"form-group","row"],["type","button",1,"btn","btn-success",3,"click"],[1,"bx","bx-save"],[1,"col-md-4","text-end"],["type","button",1,"btn","btn-outline-danger",3,"click"],[1,"bx","bx-times"],[1,"text-danger"]],template:function(o,e){1&o&&(t.YNc(0,A,4,1,"ng-container",0),t.TgZ(1,"div",1)(2,"div",2)(3,"h4",3),t._uU(4,"EDITER PRODUIT"),t.qZA()()(),t.YNc(5,E,63,37,"ng-container",0)),2&o&&(t.Q6J("ngIf",e.lastProductId),t.xp6(5),t.Q6J("ngIf",e.productForm))},directives:[l.O5,c.yS,u._Y,u.JL,u.sg,u.Fj,u.JJ,u.oH,u.wV],pipes:[b.h,P],styles:[""]}),r})();function Q(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(2);return i.navigateTo(i.productsIndex-1)}),t._UZ(1,"i",10),t._uU(2," Pr\xe9c\xe9dent "),t.qZA()}}function O(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(o);const i=t.oxw(2);return i.navigateTo(i.productsIndex+1)}),t._uU(1," Suivant "),t._UZ(2,"i",11),t.qZA()}}function J(r,n){if(1&r&&(t.TgZ(0,"div",0)(1,"div",6),t.YNc(2,Q,3,0,"button",7),t.qZA(),t.TgZ(3,"div",8),t.YNc(4,O,3,0,"button",7),t.qZA()()),2&r){const o=t.oxw();t.xp6(2),t.Q6J("ngIf",o.productsIndex>0),t.xp6(2),t.Q6J("ngIf",o.products.length>=o.productsCount)}}function Y(r,n){1&r&&(t.ynx(0),t._UZ(1,"i",20),t.BQk())}function S(r,n){1&r&&(t.ynx(0),t._UZ(1,"i",21),t.BQk())}function M(r,n){if(1&r&&(t.TgZ(0,"div",12)(1,"div",13)(2,"div",14)(3,"h4",15),t._uU(4),t.qZA(),t.TgZ(5,"div"),t.YNc(6,Y,2,0,"ng-container",16),t.YNc(7,S,2,0,"ng-container",16),t.TgZ(8,"div")(9,"strong"),t._uU(10,"Code"),t.qZA(),t._uU(11),t.qZA()()(),t.TgZ(12,"div",17)(13,"a",18)(14,"small"),t._uU(15,"Afficher"),t.qZA()(),t.TgZ(16,"a",19)(17,"small"),t._uU(18,"Editer"),t.qZA()()()()()),2&r){const o=n.$implicit;t.xp6(4),t.Oqu(o.name),t.xp6(2),t.Q6J("ngIf",o.barCode),t.xp6(1),t.Q6J("ngIf",!o.barCode),t.xp6(4),t.hij(": ",o.productId,""),t.xp6(2),t.MGl("routerLink","/products/",o.productId,"/details"),t.xp6(3),t.MGl("routerLink","/products/",o.productId,"/edit")}}function k(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return i.navigateTo(i.productsIndex-1)}),t._UZ(1,"i",10),t._uU(2," Pr\xe9c\xe9dent "),t.qZA()}}function N(r,n){if(1&r){const o=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(o);const i=t.oxw();return i.navigateTo(i.productsIndex+1)}),t._uU(1," Suivant "),t._UZ(2,"i",11),t.qZA()}}const D=[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class r{constructor(o,e){this.productsApiServ=o,this.route=e,this.products=[],this.productsIndex=0,this.productsCount=20}ngOnInit(){this.querify()}querify(){this.route.queryParams.subscribe(o=>{+o.n&&(this.productsCount=+o.n),this.navigateTo(+o.i?+o.i:0)})}navigateTo(o=0){this.productsIndex=o,this.getProducts()}getProducts(){this.productsApiServ.index("",this.productsIndex,this.productsCount).subscribe(o=>{this.products=o})}}return r.\u0275fac=function(o){return new(o||r)(t.Y36(d.b0),t.Y36(c.gz))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-products-list"]],decls:15,vars:4,consts:[[1,"row"],[1,"col-md-12","text-end"],["routerLink","/products/0/edit","title","Cr\xe9er produit",1,"btn","btn-sm","btn-outline-success","mt-1","mb-2"],[1,"bx","bx-plus-circle"],["class","row",4,"ngIf"],["class","col-md-3 col-xs-6",4,"ngFor","ngForOf"],[1,"col"],["type","button","class","btn btn-sm btn-light",3,"click",4,"ngIf"],[1,"col","text-end"],["type","button",1,"btn","btn-sm","btn-light",3,"click"],[1,"bx","bx-left"],[1,"bx","bx-right"],[1,"col-md-3","col-xs-6"],[1,"card","text-center","mb-1","mt-1"],[1,"card-body"],[1,"card-text"],[4,"ngIf"],[1,"card-footer"],[1,"btn","btn-sm","btn-outline-info","pt-1","mt-2","mb-2",3,"routerLink"],[1,"btn","btn-sm","btn-outline-info","pt-1","mt-2","mb-2","ms-1",3,"routerLink"],[1,"bx","bx-barcode"],[1,"bx"]],template:function(o,e){1&o&&(t.TgZ(0,"h4"),t._uU(1,"CATALOGUE DES PRODUITS"),t.qZA(),t.TgZ(2,"div",0)(3,"div",1)(4,"a",2),t._UZ(5,"i",3),t._uU(6," Cr\xe9er produit"),t.qZA()()(),t.YNc(7,J,5,2,"div",4),t.TgZ(8,"div",0),t.YNc(9,M,19,6,"div",5),t.qZA(),t.TgZ(10,"div",0)(11,"div",6),t.YNc(12,k,3,0,"button",7),t.qZA(),t.TgZ(13,"div",8),t.YNc(14,N,3,0,"button",7),t.qZA()()),2&o&&(t.xp6(7),t.Q6J("ngIf",e.products.length>=e.productsCount),t.xp6(2),t.Q6J("ngForOf",e.products),t.xp6(3),t.Q6J("ngIf",e.productsIndex>0),t.xp6(2),t.Q6J("ngIf",e.products.length>=e.productsCount))},directives:[c.yS,l.O5,l.sg],styles:[""]}),r})()},{path:":id",component:(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-products"]],decls:7,vars:0,consts:[[1,"text-end","mb-2"],["routerLink","/products/list","routerLinkActive","active"]],template:function(o,e){1&o&&(t.TgZ(0,"div",0)(1,"a",1),t._uU(2,"Tous les produits"),t.qZA()(),t._UZ(3,"router-outlet")(4,"hr"),t._uU(5,"\nPRODUIT\n"),t._UZ(6,"hr"))},directives:[c.yS,c.Od,c.lC],styles:[""]}),r})(),children:[{path:"edit",canActivate:[a.G],component:L},{path:"details",component:x}]}];let w=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[c.Bz.forChild(D)],c.Bz]}),r})();var V=s(6315);let B=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[[l.ez,w,V.m]]}),r})()},6152:(h,p,s)=>{s.d(p,{h:()=>a});var l=s(1223);let a=(()=>{class c{transform(d,...u){return d}}return c.\u0275fac=function(d){return new(d||c)},c.\u0275pipe=l.Yjl({name:"toFormControl",type:c,pure:!0}),c})()},2277:(h,p,s)=>{s.d(p,{M:()=>l});const l={setFocus:function a(d,u=0){!d||setTimeout(()=>{d.nativeElement.focus()},u)},removeFocus:function c(d,u=0){!d||setTimeout(()=>{d.nativeElement.blur()},u)},getFormGroupErrors:function t(d){const u=[];return Object.keys(d.controls).forEach(m=>{var _;const g=null===(_=d.get(m))||void 0===_?void 0:_.errors;null!=g&&Object.keys(g).forEach(Z=>{u.push(m+", "+Z+": "+g[Z])})}),u}}}}]);